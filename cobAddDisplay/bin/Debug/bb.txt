000000 IDENTIFICATION DIVISION.
000000 PROGRAM-ID. HBHUN551 .
000000 DATE-WRITTEN.
000000 DATE-COMPILED.
000000 ENVIRONMENT DIVISION.
000000 CONFIGURATION SECTION.
000000 SOURCE-COMPUTER.        ACOS.
000000 OBJECT-COMPUTER.        ACOS.
      *20141114修正開始
000000* SPECIAL-NAMES.
000000*     ITG005  IS  SPCOMMIT.
      *20141114修正終了
000000 INPUT-OUTPUT SECTION.
000000 FILE-CONTROL.
000000     SELECT 運用管理Ｆ                                                         ZZZカイギョウZZZ000000                  ASSIGN             VRUNYKAN-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       IS  RELATIVE                       ZZZカイギョウZZZ000000                  ACCESS             RANDOM                               ZZZカイギョウZZZ000000                  RELATIVE           UNK-RKEY                             ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 世代別運用管理Ｆ                                                      ZZZカイギョウZZZ000000                  ASSIGN             VRSEUNKN-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       IS  RELATIVE                       ZZZカイギョウZZZ000000                  ACCESS             RANDOM                               ZZZカイギョウZZZ000000                  RELATIVE           SUK-RKEY                             ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 発売開始ゲームＦ−Ａ                                                    ZZZカイギョウZZZ000000                  ASSIGN             VIKASGMA-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       IS INDEXED                         ZZZカイギョウZZZ000000                  ACCESS  MODE       RANDOM                               ZZZカイギョウZZZ000000                  RECORD  KEY        ＫＡＧＭゲームＩＤ                            ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 発売開始ゲームＦ−Ｂ                                                    ZZZカイギョウZZZ000000                  ASSIGN             VIKASGMB-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       IS INDEXED                         ZZZカイギョウZZZ000000                  ACCESS  MODE       RANDOM                               ZZZカイギョウZZZ000000                  RECORD  KEY        ＫＡＧＭＢゲームＩＤ                           ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 日別販売ＣＨ別売場売上ＷＦ                                                 ZZZカイギョウZZZ000000                  ASSIGN             SQWHURCH-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       SEQUENTIAL                           ZZZカイギョウZZZ000000                  ACCESS  MODE       SEQUENTIAL                           ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 売場Ｆ                                                           ZZZカイギョウZZZ000000                  ASSIGN             VIURIBA-MSD                              ZZZカイギョウZZZ000000                  ORGANIZATION       IS INDEXED                         ZZZカイギョウZZZ000000                  ACCESS  MODE       RANDOM                               ZZZカイギョウZZZ000000                  RECORD  KEY        ＵＲＢＡ売場コード                            ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 業者Ｆ                                                           ZZZカイギョウZZZ000000                  ASSIGN             VIGYOSYA-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       IS INDEXED                         ZZZカイギョウZZZ000000                  ACCESS  MODE       RANDOM                               ZZZカイギョウZZZ000000                  RECORD  KEY        ＧＹＳＡ業者コードＸ                            ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 日別販売ＣＨ別売上累計Ｆ                                                  ZZZカイギョウZZZ000000                  ASSIGN             VIHCHNUR-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       IS INDEXED                         ZZZカイギョウZZZ000000                  ACCESS  MODE       DYNAMIC                              ZZZカイギョウZZZ000000                  RECORD  KEY        ＨＣＨＮレコードキー                           ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000     SELECT 販売チャネル別売上累計Ｆ                                                  ZZZカイギョウZZZ000000                  ASSIGN             VICHNURI-MSD                             ZZZカイギョウZZZ000000                  ORGANIZATION       IS INDEXED                         ZZZカイギョウZZZ000000                  ACCESS  MODE       RANDOM                               ZZZカイギョウZZZ000000                  RECORD  KEY        ＣＨＵＲレコードキー                           ZZZカイギョウZZZ000000*                  FILE STATUS          FL-STS1  FL-STS2.                   ZZZカイギョウZZZ000000                  FILE STATUS          FL-STS1.
000000 DATA DIVISION.
000000 FILE SECTION.
000000 FD  日別販売ＣＨ別売場売上ＷＦ                                                        ZZZカイギョウZZZ000000     LABEL RECORD STANDARD                                               ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "SQWHURCH".
      *20141114追加終了
000000 01  日別販売ＣＨ別売場売上ＷＲ.
000000     COPY CFWUBU .
000000 FD  発売開始ゲームＦ−Ａ                                                           ZZZカイギョウZZZ000000     LABEL RECORD STANDARD                                               ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VIKASGMA".
      *20141114追加終了
000000 01  発売開始ゲームＲ−Ａ.
000000     COPY CFKAGM .
000000 FD  発売開始ゲームＦ−Ｂ                                                           ZZZカイギョウZZZ000000     LABEL RECORD STANDARD                                               ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VIKASGMB".
      *20141114追加終了
000000 01  発売開始ゲームＲ−Ｂ.
000000     COPY CFKAGM REPLACING                                                ZZZカイギョウZZZ000000                 //ＫＡＧＭ//  BY  //ＫＡＧＭＢ// .
000000 FD  運用管理Ｆ                                                                ZZZカイギョウZZZ      *20141114修正開始                                                          ZZZカイギョウZZZ000000*     RECORD  VARYING  IN  SIZEZZZカイギョウZZZ           LABEL RECORD STANDARDZZZカイギョウZZZ      *20141114修正終了ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VRUNYKAN".
      *20141114追加終了
000000* 01  運用管理Ｒ２.
000000*     COPY CFUNK2 .
000000 01  運用管理Ｒ１.
000000     COPY CFUNK1 .
000000* 01  運用管理Ｒ３.
000000*     COPY CFUNK3 .
000000 FD  世代別運用管理Ｆ                                                             ZZZカイギョウZZZ      *20141114修正開始                                                          ZZZカイギョウZZZ000000*     RECORD  VARYING  IN  SIZEZZZカイギョウZZZ           LABEL RECORD STANDARDZZZカイギョウZZZ      *20141114修正終了ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VRSEUNKN".
      *20141114追加終了
000000 01  世代別運用管理Ｒ.
000000     COPY CFSUK1 .
000000 FD  業者Ｆ                                                                  ZZZカイギョウZZZ000000     LABEL RECORD STANDARD                                               ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VIGYOSYA".
      *20141114追加終了
000000 01  業者Ｒ.
000000     COPY CFGYSA .
000000 FD  売場Ｆ                                                                  ZZZカイギョウZZZ000000     LABEL RECORD STANDARD                                               ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VIURIBA".
      *20141114追加終了
000000 01  売場Ｒ.
000000     COPY CFURBA .
000000 FD  日別販売ＣＨ別売上累計Ｆ                                                         ZZZカイギョウZZZ000000     LABEL RECORD STANDARD                                               ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VIHCHNUR".
      *20141114追加終了
000000 01  日別販売ＣＨ別売上累計Ｒ.
000000     COPY CFHCHN .
000000 FD  販売チャネル別売上累計Ｆ                                                         ZZZカイギョウZZZ000000     LABEL RECORD STANDARD                                               ZZZカイギョウZZZ      *20141114追加開始ZZZカイギョウZZZ           VALUE  OF IDENTIFICATION IS "VICHNURI".
      *20141114追加終了
000000 01  販売チャネル別売上累計Ｒ.
000000     COPY CFCHUR .
000000 WORKING-STORAGE SECTION.
000000 01  作業エリア.
000000   03  ＷＫ−売上金額               PIC 9(13)  USAGE  COMP-3.
000000   03  ＷＫ−世代区分               PIC 9(01).
000000   03  ＷＫ−年度                   PIC 9(04).
000000   03  ＷＫ−バッチ業務日付         PIC 9(08).
000000   03  ＷＫ−売場コード             PIC X(06).
000000   03  ＷＫ−ゲームＩＤ.
000000     05  ＷＫ−ゲームタイプ         PIC 9(02).
000000     05  ＷＫ−ブロックコード       USAGE COMP-1.
000000     05  ＷＫ−回号                 USAGE COMP-1.
000000   03  ＷＫ−売上ＴＢＬ             USAGE COMP-1.
000000   03  ＷＫ−実発売開始日           PIC 9(08).
000000   03  ＷＫ−実発売開始日Ｒ         REDEFINES  ＷＫ−実発売開始日.
000000     05  ＷＫ−実発売開始日Ｙ       PIC 9(04).
000000     05  ＷＫ−実発売開始日Ｍ       PIC 9(02).
000000     05  ＷＫ−実発売開始日Ｄ       PIC 9(02).
000000 01  利用者制御変数エリア.
000000   03  変数ＣＯＭＭＩＴ件数         PIC 9(05).
000000 01  カウンタ.
000000   03  ＣＮＴゲーム終了状態         USAGE COMP-1.
000000   03  ＣＮＴ−売上ＴＢＬ           USAGE COMP-1.
000000   03  CNT-COMMIT                   PIC 9(05).
000000 01  相対キー.
      *20141114修正開始
000000*   03  UNK-RKEY                     USAGE COMP-2.
000000*   03  SUK-RKEY                     USAGE COMP-2.
000000   03  UNK-RKEY                     PIC 9(08).
000000   03  SUK-RKEY                     PIC 9(08).
      *20141114修正終了
000000 01  フラグ.
000000   03  ファイルステータス.
000000     05  FL-STS1                    PIC X(02).
000000     05  FL-STS2                    PIC 9(05).
000000   03  ファイル終了フラグ.
000000     05  ＥＮＤ−売上ＷＦ           PIC 9(01).
000000   03  テーブル終了フラグ.
000000     05  ＥＮＤ−ゲーム終了状態     PIC 9(01).
000000 01  Ｔ日別販売ＣＨ別売上累計.
      *20141114修正開始
000000*   02  Ｔ累計日別販売ＣＨ別累計    OCCURS 15000.
         02  Ｔ累計日別販売ＣＨ別累計    OCCURS 1500.
      *20141114修正終了
000000     03  Ｔ累計レコードキー.
000000       05  Ｔ累計年度                    PIC 9(4).
000000       05  Ｔ累計販売チャネル            PIC 9(2).
000000       05  Ｔ累計ゲームＩＤ.
000000         07  Ｔ累計ゲームタイプ          PIC 9(2).
000000         07  Ｔ累計ブロックコード        USAGE COMP-1.
000000         07  Ｔ累計回号                  USAGE COMP-1.
000000     03  Ｔ累計売上金額        PIC 9(13) USAGE COMP-3.
000000 PROCEDURE DIVISION .
000000 MAIN-RTN .
000000     PERFORM S000-RTN THRU CX00002
000000     PERFORM P000-RTN THRU CX00003
000000     PERFORM E000-RTN THRU CX00004 .
000000 CX00001. STOP RUN.
000000 S000-RTN .
      *20141114修正開始
000000*       ACCEPT  変数ＣＯＭＭＩＴ件数  FROM  SPCOMMIT.
             MOVE ZERO TO 変数ＣＯＭＭＩＴ件数.
      *20141114修正終了
000000       OPEN INPUT 運用管理Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00011.
000000         DISPLAY "HBHUN551-01 VRUNYKAN OPEN ERROR " ,                     ZZZカイギョウZZZ000000                           FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00011.
000000       OPEN INPUT 世代別運用管理Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00012.
000000         DISPLAY "HBHUN551-02 VRSEUNKN OPEN ERROR " ,                     ZZZカイギョウZZZ000000                           FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00012.
000000       OPEN INPUT 売場Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00013.
000000         DISPLAY "HBHUN551-03 VIURIBA OPEN ERROR " ,                      ZZZカイギョウZZZ000000                           FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00013.
000000       OPEN INPUT 業者Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00014.
000000         DISPLAY "HBHUN551-04 VIGYOSYA OPEN ERROR " ,                     ZZZカイギョウZZZ000000                           FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00014.
000000       OPEN INPUT 日別販売ＣＨ別売場売上ＷＦ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00015.
000000         DISPLAY "HBHUN551-05 SQWHURCH OPEN ERROR " ,                     ZZZカイギョウZZZ000000                           FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00015.
000000       OPEN I-O   日別販売ＣＨ別売上累計Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00016.
000000         DISPLAY "HBHUN551-06 VIHCHNUR OPEN ERROR " ,                     ZZZカイギョウZZZ000000                           FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00016.
000000       OPEN I-O   販売チャネル別売上累計Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00017.
000000         DISPLAY "HBHUN551-07 VICHNURI OPEN ERROR " ,                     ZZZカイギョウZZZ000000                           FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00017.
000000     MOVE 1 TO UNK-RKEY
000000       READ  運用管理Ｆ INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00018.
000000         DISPLAY "HBHUN551-08 VRUNYKAN READ ERROR ",                      ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000         STOP RUN .
000000 CX00018.
000000     IF NOT(ＵＮＫ１業務日付 = ZZZカイギョウZZZ            ＵＮＫ１バッチ業務日付) GO TO CX00019.
000000     MOVE ＵＮＫ１世代区分 TO ＷＫ−世代区分 .
000000     GO TO CX00020.
000000 CX00019.
000000     IF NOT(ＵＮＫ１世代区分 = 1) GO TO CX00021.
000000     MOVE 2 TO ＷＫ−世代区分 .
000000     GO TO CX00022.
000000 CX00021.
000000     MOVE 1 TO ＷＫ−世代区分 .
000000 CX00022.
000000 CX00020.
000000     IF NOT(ＷＫ−世代区分 = 1) GO TO CX00023.
000000         OPEN  INPUT  発売開始ゲームＦ−Ａ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00024.
000000           DISPLAY "HBHUN551-09 VIKASGMA OPEN ERROR ",                    ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00024.
000000     GO TO CX00025.
000000 CX00023.
000000         OPEN  INPUT  発売開始ゲームＦ−Ｂ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00026.
000000           DISPLAY "HBHUN551-10 VIKASGMB OPEN ERROR ",                    ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00026.
000000 CX00025.
000000       INITIALIZE Ｔ日別販売ＣＨ別売上累計 .
000000 CX00002. EXIT.
000000 P000-RTN .
000000     PERFORM P100-RTN THRU CX00005
000000     PERFORM P200-RTN THRU CX00006
000000     PERFORM P300-RTN THRU CX00009 .
000000 CX00003. EXIT.
000000 E000-RTN .
000000       COMMIT
000000       CLOSE 運用管理Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00027.
000000         DISPLAY "HBHUN551-11 VRUNYKAN CLOSE ERROR " ,                    ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00027.
000000       CLOSE 世代別運用管理Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00028.
000000         DISPLAY "HBHUN551-12 VRSEUNKN CLOSE ERROR " ,                    ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00028.
000000       CLOSE 売場Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00029.
000000         DISPLAY "HBHUN551-13 VIURIBA CLOSE ERROR " ,                     ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00029.
000000       CLOSE 業者Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00030.
000000         DISPLAY "HBHUN551-14 VIGYOSYA CLOSE ERROR " ,                    ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00030.
000000       CLOSE 日別販売ＣＨ別売場売上ＷＦ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00031.
000000         DISPLAY "HBHUN551-15 SQWHURCH CLOSE ERROR " ,                    ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00031.
000000       CLOSE 日別販売ＣＨ別売上累計Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00032.
000000         DISPLAY "HBHUN551-16 VIHCHNUR CLOSE ERROR " ,                    ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00032.
000000       CLOSE 販売チャネル別売上累計Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00033.
000000         DISPLAY "HBHUN551-17 VICHNURI CLOSE ERROR " ,                    ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00033.
000000     IF NOT(ＷＫ−世代区分 = 1) GO TO CX00034.
000000         CLOSE  発売開始ゲームＦ−Ａ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00035.
000000           DISPLAY "HBHUN551-18 VIKASGMA CLOSE ERROR ",                   ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00035.
000000     GO TO CX00036.
000000 CX00034.
000000         CLOSE  発売開始ゲームＦ−Ｂ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00037.
000000           DISPLAY "HBHUN551-19 VIKASGMB CLOSE ERROR ",                   ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00037.
000000 CX00036.
      *20141114修正開始
000000*       @ZCTMSGOT(MSGID = #BH001,
000000*                 PROGID = HBHUN551); .
      *20141114修正終了
000000 CX00004. EXIT.
000000 P100-RTN .
000000     MOVE 0 TO ＥＮＤ−売上ＷＦ
000000     MOVE 0 TO ＷＫ−売上金額
000000     MOVE 0 TO CNT-COMMIT
000000       READ 日別販売ＣＨ別売場売上ＷＦ AT END    ,
000000                        MOVE 1 TO ＥＮＤ−売上ＷＦ.
000000     IF NOT(FL-STS1 NOT = "00" AND "10") GO TO CX00038.
000000         DISPLAY "HBHUN551-20 SQWHURCH READ ERROR " ,                     ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2
000000         STOP RUN .
000000 CX00038.
000000     MOVE ＷＵＢＵ売場コード TO ＷＫ−売場コード .
000000     MOVE ＷＵＢＵゲームＩＤ TO ＷＫ−ゲームＩＤ .
000000 CX00039. IF NOT(ＥＮＤ−売上ＷＦ = 0) GO TO CX00040.
000000 CX00041. IF NOT( (ＥＮＤ−売上ＷＦ = 0) AND ZZZカイギョウZZZ            (ＷＫ−売場コード = ＷＵＢＵ売場コード) AND           ZZZカイギョウZZZ000000     (ＷＫ−ゲームＩＤ = ＷＵＢＵゲームＩＤ)) GO TO CX00042.
000000     COMPUTE ＷＫ−売上金額 = ＷＫ−売上金額 +                                          ZZZカイギョウZZZ000000                             ＷＵＢＵ売上金額
000000           READ 日別販売ＣＨ別売場売上ＷＦ AT END    ,
000000                        MOVE 1 TO ＥＮＤ−売上ＷＦ .
000000     IF NOT(FL-STS1 NOT = "00" AND "10") GO TO CX00043.
000000             DISPLAY "HBHUN551-21 SQWHURCH READ ERROR " ,                 ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2
000000             STOP RUN .
000000 CX00043.
000000     GO TO CX00041.
000000 CX00042.
000000     IF NOT(ＷＫ−世代区分 = 1) GO TO CX00044.
000000     MOVE ＷＫ−ゲームＩＤ TO ＫＡＧＭゲームＩＤ
000000           READ  発売開始ゲームＦ−Ａ INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00045.
000000             DISPLAY "HBHUN551-22 VIKASGMA READ ERROR ",                  ZZZカイギョウZZZ000000                       FL-STS1 " " FL-STS2
000000             STOP RUN .
000000 CX00045.
000000     MOVE ＫＡＧＭ実発売開始日 TO ＷＫ−実発売開始日 .
000000     GO TO CX00046.
000000 CX00044.
000000     MOVE ＷＫ−ゲームＩＤ TO ＫＡＧＭＢゲームＩＤ
000000           READ  発売開始ゲームＦ−Ｂ INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00047.
000000             DISPLAY "HBHUN551-23 VIKASGMB READ ERROR ",                  ZZZカイギョウZZZ000000                       FL-STS1 " " FL-STS2
000000             STOP RUN .
000000 CX00047.
000000     MOVE ＫＡＧＭＢ実発売開始日 TO ＷＫ−実発売開始日 .
000000 CX00046.
000000     IF NOT(ＷＫ−実発売開始日Ｍ >= 1 AND ZZZカイギョウZZZ            ＷＫ−実発売開始日Ｍ <= 3) GO TO CX00048.
000000     COMPUTE ＷＫ−年度 = ＷＫ−実発売開始日Ｙ - 1 .
000000     GO TO CX00049.
000000 CX00048.
000000     MOVE ＷＫ−実発売開始日Ｙ TO ＷＫ−年度 .
000000 CX00049.
000000     MOVE ＷＫ−売場コード TO ＵＲＢＡ売場コード
000000         READ  売場Ｆ INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00050.
000000           DISPLAY "HBHUN551-24 VIURIBA READ ERROR ",                     ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00050.
000000     MOVE ＵＲＢＡ業者コード TO ＧＹＳＡ業者コード
000000         READ  業者Ｆ INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00051.
000000           DISPLAY "HBHUN551-25 VIGYOSYA READ ERROR ",                    ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00051.
000000     MOVE ＷＫ−年度 TO ＨＣＨＮ年度
000000     MOVE ＧＹＳＡ販売チャネルコード TO ＨＣＨＮ販売チャネル
000000     MOVE ＷＫ−ゲームＩＤ TO ＨＣＨＮゲームＩＤ
000000         READ  日別販売ＣＨ別売上累計Ｆ ,                                             ZZZカイギョウZZZ000000                                  INVALID CONTINUE .
000000     IF NOT(FL-STS1 = "00") GO TO CX00052.
000000     COMPUTE ＨＣＨＮ売上金額 = ＨＣＨＮ売上金額 + ＷＫ−売上金額
000000           REWRITE 日別販売ＣＨ別売上累計Ｒ ,                                         ZZZカイギョウZZZ000000                                    INVALID CONTINUE .
               DISPLAY "REWRITE" UPON CONSOLE
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00053.
000000             DISPLAY "HBHUN551-26 VIHCHNUR REWRITE ERROR ",               ZZZカイギョウZZZ000000                       FL-STS1 " " FL-STS2
000000             STOP RUN .
000000 CX00053.
000000     GO TO CX00054.
000000 CX00052. IF NOT(FL-STS1 = "23") GO TO CX00055.
000000     MOVE ＷＫ−年度 TO ＨＣＨＮ年度
000000     MOVE ＧＹＳＡ販売チャネルコード TO ＨＣＨＮ販売チャネル
000000     MOVE ＷＫ−ゲームＩＤ TO ＨＣＨＮゲームＩＤ
000000     MOVE ＷＫ−売上金額 TO ＨＣＨＮ売上金額
000000     MOVE SPACE TO ＨＣＨＮ予備
000000           WRITE 日別販売ＣＨ別売上累計Ｒ ,                                           ZZZカイギョウZZZ000000                                    INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00056.
000000             DISPLAY "HBHUN551-27 VIHCHNUR WRITE ERROR ",                 ZZZカイギョウZZZ000000                       FL-STS1 " " FL-STS2
000000             STOP RUN .
000000 CX00056.
000000     GO TO CX00054.
000000 CX00055.
000000           DISPLAY "HBHUN551-28 VIHCHNUR READ ERROR ",                    ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00054.
000000     COMPUTE CNT-COMMIT = CNT-COMMIT + 1 .
000000     IF NOT(変数ＣＯＭＭＩＴ件数 < CNT-COMMIT) GO TO CX00057.
000000           COMMIT
000000     MOVE 0 TO CNT-COMMIT .
000000 CX00057.
000000     COMPUTE CNT-COMMIT = CNT-COMMIT + 1 .
000000     IF NOT(変数ＣＯＭＭＩＴ件数 < CNT-COMMIT) GO TO CX00058.
000000           COMMIT
000000     MOVE 0 TO CNT-COMMIT .
000000 CX00058.
000000     MOVE ＷＵＢＵ売場コード TO ＷＫ−売場コード
000000     MOVE ＷＵＢＵゲームＩＤ TO ＷＫ−ゲームＩＤ
000000     MOVE 0 TO ＷＫ−売上金額 .
000000     GO TO CX00039.
000000 CX00040.
000000 CX00005. EXIT.
000000 P200-RTN .
000000     PERFORM P210-RTN THRU CX00007 .
000000     IF NOT(ＷＫ−世代区分 = 1) GO TO CX00059.
000000     MOVE 1 TO SUK-RKEY .
000000     GO TO CX00060.
000000 CX00059.
000000     MOVE 2 TO SUK-RKEY .
000000 CX00060.
000000       READ  世代別運用管理Ｆ INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00061.
000000         DISPLAY "HBHUN551-29 VRSEUNKN READ ERROR ",                      ZZZカイギョウZZZ000000                     FL-STS1 " " FL-STS2
000000         STOP RUN .
000000 CX00061.
000000     MOVE 0 TO ＥＮＤ−ゲーム終了状態 .
000000     MOVE 1 TO ＣＮＴゲーム終了状態 .
000000 CX00062. IF NOT( (ＥＮＤ−ゲーム終了状態 = 0) AND ZZZカイギョウZZZ            (ＣＮＴゲーム終了状態 <= 90)                ZZZカイギョウZZZ000000     ) GO TO CX00063.
000000     IF NOT( (ＳＵＫ１ゲームタイプ (ＣＮＴゲーム終了状態) = 0) ZZZカイギョウZZZ         AND (ＳＵＫ１ブロックコード (             ZZZカイギョウZZZ000000     ＣＮＴゲーム終了状態) = 0) AND ZZZカイギョウZZZ           (ＳＵＫ１回号 (ＣＮＴゲーム終了状態) = 0)                       ZZZカイギョウZZZ000000     ) GO TO CX00064.
000000     MOVE 1 TO ＥＮＤ−ゲーム終了状態 .
000000     GO TO CX00065.
000000 CX00064.
000000     IF NOT(ＳＵＫ１Ｇ別抽せん対象Ｓ (ＣＮＴゲーム終了状態) = ZZZカイギョウZZZ           1) GO TO CX00066.
000000     PERFORM P220-RTN THRU CX00008 .
000000 CX00066.
000000 CX00065.
000000     COMPUTE ＣＮＴゲーム終了状態 = ＣＮＴゲーム終了状態 + 1 .
000000     GO TO CX00062.
000000 CX00063.
000000 CX00006. EXIT.
000000 P210-RTN .
000000     MOVE 0 TO ＥＮＤ−売上ＷＦ .
000000     MOVE 0 TO ＣＮＴ−売上ＴＢＬ .
000000     MOVE LOW-VALUE TO ＨＣＨＮレコードキー .
000000       START 日別販売ＣＨ別売上累計Ｆ KEY > ,                                         ZZZカイギョウZZZ000000                                      ＨＣＨＮレコードキー                          ZZZカイギョウZZZ000000             INVALID CONTINUE.
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00067.
000000           DISPLAY "HBHUN551-30 VIHCHNUR START ERROR " ,                  ZZZカイギョウZZZ000000                       FL-STS1 " " FL-STS2
000000           STOP RUN .
000000 CX00067.
000000 CX00068. IF NOT(ＥＮＤ−売上ＷＦ = 0) GO TO CX00069.
000000         READ 日別販売ＣＨ別売上累計Ｆ NEXT ,                                         ZZZカイギョウZZZ000000                          AT END MOVE 1 TO ＥＮＤ−売上ＷＦ .
000000     IF NOT(FL-STS1 NOT = "00" AND "10") GO TO CX00070.
000000           DISPLAY "HBHUN551-31 VIHCHNUR READ ERROR " ,                   ZZZカイギョウZZZ000000                            FL-STS1 " " FL-STS2.
000000           STOP RUN .
000000 CX00070.
000000     IF NOT(ＥＮＤ−売上ＷＦ = 0) GO TO CX00071.
000000     COMPUTE ＣＮＴ−売上ＴＢＬ = ＣＮＴ−売上ＴＢＬ + 1
000000     MOVE ＨＣＨＮ年度 TO Ｔ累計年度 (ＣＮＴ−売上ＴＢＬ)
000000     MOVE ＨＣＨＮ販売チャネル TO ZZZカイギョウZZZ           Ｔ累計販売チャネル (ＣＮＴ−売上ＴＢＬ)
000000     MOVE ＨＣＨＮゲームタイプ TO ZZZカイギョウZZZ           Ｔ累計ゲームタイプ (ＣＮＴ−売上ＴＢＬ)
000000     MOVE ＨＣＨＮブロックコード TO ZZZカイギョウZZZ           Ｔ累計ブロックコード (ＣＮＴ−売上ＴＢＬ)
000000     MOVE ＨＣＨＮ回号 TO ZZZカイギョウZZZ           Ｔ累計回号 (ＣＮＴ−売上ＴＢＬ)
000000     MOVE ＨＣＨＮ売上金額 TO Ｔ累計売上金額 (ＣＮＴ−売上ＴＢＬ) .
000000 CX00071.
000000     GO TO CX00068.
000000 CX00069.
000000     MOVE ＣＮＴ−売上ＴＢＬ TO ＷＫ−売上ＴＢＬ .
000000       COMMIT
000000       CLOSE 日別販売ＣＨ別売上累計Ｆ.
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00072.
000000         DISPLAY "HBHUN551-32 VIHCHNUR CLOSE ERROR " ,                    ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2.
000000         STOP RUN .
000000 CX00072.
000000 CX00007. EXIT.
000000 P220-RTN .
000000     MOVE 1 TO ＣＮＴ−売上ＴＢＬ
000000     MOVE ZERO TO CNT-COMMIT .
000000 CX00073. IF NOT(ＣＮＴ−売上ＴＢＬ <= ZZZカイギョウZZZ           ＷＫ−売上ＴＢＬ) GO TO CX00074.
000000     IF NOT(ＳＵＫ１ゲームＩＤ (ＣＮＴゲーム終了状態) = ZZZカイギョウZZZ            Ｔ累計ゲームＩＤ (ＣＮＴ−売上ＴＢＬ)                 ZZZカイギョウZZZ000000     ) GO TO CX00075.
000000     MOVE Ｔ累計年度 (ＣＮＴ−売上ＴＢＬ) TO ＣＨＵＲ年度
000000     MOVE Ｔ累計販売チャネル (ＣＮＴ−売上ＴＢＬ) TO ZZZカイギョウZZZ            ＣＨＵＲ販売チャネルコード
000000             READ 販売チャネル別売上累計Ｆ INVALID CONTINUE.
000000     IF NOT(FL-STS1 = "00") GO TO CX00076.
000000     COMPUTE ＣＨＵＲ売上金額 = ＣＨＵＲ売上金額 + ZZZカイギョウZZZ           Ｔ累計売上金額 (ＣＮＴ−売上ＴＢＬ)
000000                 REWRITE 販売チャネル別売上累計Ｒ ,                                   ZZZカイギョウZZZ000000                                     INVALID CONTINUE .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00077.
000000                   DISPLAY "HBHUN551-33 VICHNURI REWRITE ERROR " ,        ZZZカイギョウZZZ000000                        FL-STS1 " " FL-STS2 UPON CONSOLE.
000000                   STOP RUN .
000000 CX00077.
000000     GO TO CX00078.
000000 CX00076. IF NOT(FL-STS1 = "23") GO TO CX00079.
000000     MOVE Ｔ累計年度 (ＣＮＴ−売上ＴＢＬ) TO ＣＨＵＲ年度
000000     MOVE Ｔ累計販売チャネル (ＣＮＴ−売上ＴＢＬ) TO ZZZカイギョウZZZ           ＣＨＵＲ販売チャネルコード
000000     MOVE Ｔ累計売上金額 (ＣＮＴ−売上ＴＢＬ) TO ＣＨＵＲ売上金額
000000                 WRITE 販売チャネル別売上累計Ｒ INVALID CONTINUE.
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00080.
000000                   DISPLAY "HBHUN551-34 VICHNURI WRITE ERROR " ,          ZZZカイギョウZZZ000000                        FL-STS1 " " FL-STS2 UPON CONSOLE.
000000                   STOP RUN .
000000 CX00080.
000000     GO TO CX00078.
000000 CX00079.
000000                 DISPLAY "HBHUN551-35 VICHNURI READ ERROR " ,             ZZZカイギョウZZZ000000                        FL-STS1 " " FL-STS2 UPON CONSOLE.
000000                 STOP RUN .
000000 CX00078.
000000     COMPUTE CNT-COMMIT = CNT-COMMIT + 1 .
000000     IF NOT(変数ＣＯＭＭＩＴ件数 < CNT-COMMIT) GO TO CX00081.
000000               COMMIT
000000     MOVE ZERO TO CNT-COMMIT .
000000 CX00081.
000000     MOVE 0 TO Ｔ累計年度 (ＣＮＴ−売上ＴＢＬ)
000000     MOVE 0 TO Ｔ累計販売チャネル (ＣＮＴ−売上ＴＢＬ)
000000     MOVE 0 TO Ｔ累計ゲームタイプ (ＣＮＴ−売上ＴＢＬ)
000000     MOVE 0 TO Ｔ累計ブロックコード (ＣＮＴ−売上ＴＢＬ)
000000     MOVE 0 TO Ｔ累計回号 (ＣＮＴ−売上ＴＢＬ)
000000     MOVE 0 TO Ｔ累計売上金額 (ＣＮＴ−売上ＴＢＬ) .
000000 CX00075.
000000     COMPUTE ＣＮＴ−売上ＴＢＬ = ＣＮＴ−売上ＴＢＬ + 1 .
      *20141114追加開始
           IF ＣＮＴ−売上ＴＢＬ > 1500
               MOVE 1 TO ＣＮＴ−売上ＴＢＬ
               INITIALIZE Ｔ日別販売ＣＨ別売上累計.
      *20141114追加終了
000000     GO TO CX00073.
000000 CX00074.
000000 CX00008. EXIT.
000000 P300-RTN .
000000       OPEN OUTPUT 日別販売ＣＨ別売上累計Ｆ .
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00082.
000000         DISPLAY "HBHUN551-36 VIHCHNUR OPEN ERROR " ,                     ZZZカイギョウZZZ000000                      FL-STS1 " " FL-STS2 UPON CONSOLE.
000000         STOP RUN .
000000 CX00082.
000000     MOVE 1 TO ＣＮＴ−売上ＴＢＬ
000000     MOVE 0 TO CNT-COMMIT .
000000 CX00083. IF NOT( (ＣＮＴ−売上ＴＢＬ <= ZZZカイギョウZZZ           ＷＫ−売上ＴＢＬ)) GO TO CX00084.
000000     IF NOT(Ｔ累計年度 (ＣＮＴ−売上ＴＢＬ) = 0 AND ZZZカイギョウZZZ           Ｔ累計販売チャネル (ＣＮＴ−売上ＴＢＬ) = 0           ZZZカイギョウZZZ000000     AND Ｔ累計ゲームタイプ (ＣＮＴ−売上ＴＢＬ) = 0 AND ZZZカイギョウZZZ           Ｔ累計ブロックコード (ＣＮＴ−売上ＴＢＬ) =           ZZZカイギョウZZZ000000     0 AND Ｔ累計回号 (ＣＮＴ−売上ＴＢＬ) = 0 AND ZZZカイギョウZZZ           Ｔ累計売上金額 (ＣＮＴ−売上ＴＢＬ) = 0              ZZZカイギョウZZZ000000     ) GO TO CX00085.
000000     GO TO CX00086.
000000 CX00085.
000000     MOVE Ｔ累計年度 (ＣＮＴ−売上ＴＢＬ) TO ＨＣＨＮ年度
000000     MOVE Ｔ累計販売チャネル (ＣＮＴ−売上ＴＢＬ) TO ZZZカイギョウZZZ           ＨＣＨＮ販売チャネル
000000     MOVE Ｔ累計ゲームタイプ (ＣＮＴ−売上ＴＢＬ) TO ZZZカイギョウZZZ           ＨＣＨＮゲームタイプ
000000     MOVE Ｔ累計ブロックコード (ＣＮＴ−売上ＴＢＬ) TO ZZZカイギョウZZZ           ＨＣＨＮブロックコード
000000     MOVE Ｔ累計回号 (ＣＮＴ−売上ＴＢＬ) TO ＨＣＨＮ回号
000000     MOVE Ｔ累計売上金額 (ＣＮＴ−売上ＴＢＬ) TO ＨＣＨＮ売上金額
000000           WRITE 日別販売ＣＨ別売上累計Ｒ INVALID CONTINUE.
000000     IF NOT(FL-STS1 NOT = "00") GO TO CX00087.
000000             DISPLAY "HBHUN551-37 VIHCHNUR WRITE ERROR " ,                ZZZカイギョウZZZ000000                          FL-STS1 " " FL-STS2 UPON CONSOLE.
000000             STOP RUN .
000000 CX00087.
000000     COMPUTE CNT-COMMIT = CNT-COMMIT + 1 .
000000     IF NOT(変数ＣＯＭＭＩＴ件数 < CNT-COMMIT) GO TO CX00088.
000000             COMMIT
000000     MOVE 0 TO CNT-COMMIT .
000000 CX00088.
000000 CX00086.
000000     COMPUTE ＣＮＴ−売上ＴＢＬ = ＣＮＴ−売上ＴＢＬ + 1 .
      *20141114追加開始
           IF ＣＮＴ−売上ＴＢＬ > 1500
               MOVE 1 TO ＣＮＴ−売上ＴＢＬ
               INITIALIZE Ｔ日別販売ＣＨ別売上累計.
      *20141114追加終了
000000     GO TO CX00083.
000000 CX00084.
000000 CX00009. EXIT.
